<!DOCTYPE html><html>
<head>
  <title>FIK STORE - Admin Dashboard</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
    import { getDatabase, ref, onValue, remove } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-database.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";const firebaseConfig = {
  apiKey: "AIzaSyC5aNVM7c2eUd5P-0k8jZCKhgBNWFcKO-c",
  authDomain: "fikstore-id.firebaseapp.com",
  projectId: "fikstore-id",
  databaseURL: "https://fikstore-id-default-rtdb.firebaseio.com",
  storageBucket: "fikstore-id.appspot.com",
  messagingSenderId: "323293742570",
  appId: "1:323293742570:web:5de4906939fd19d6ec9e93"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const database = getDatabase(app);

const transaksiTable = document.getElementById("transaksiTableBody");
const statusLogin = document.getElementById("statusLogin");

onAuthStateChanged(auth, (user) => {
  if (!user) {
    alert("Kamu belum login. Arahkan ke halaman login.");
    window.location.href = "admin-login.html";
  } else {
    statusLogin.innerText = "Login sebagai: " + user.email;
    loadTransaksi();
  }
});

function loadTransaksi() {
  const transaksiRef = ref(database, 'transaksi');
  onValue(transaksiRef, (snapshot) => {
    transaksiTable.innerHTML = "";
    snapshot.forEach((childSnapshot) => {
      const data = childSnapshot.val();
      const key = childSnapshot.key;
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${data.nama}</td>
        <td>${data.nomor}</td>
        <td>${data.produk}</td>
        <td>${data.metode}</td>
        <td><img src="${data.bukti}" width="50" /></td>
        <td><button onclick="hapusTransaksi('${key}')">Hapus</button></td>
      `;
      transaksiTable.appendChild(row);
    });
  });
}

window.hapusTransaksi = function(id) {
  if (confirm("Yakin ingin menghapus transaksi ini?")) {
    remove(ref(database, 'transaksi/' + id));
  }
}

window.logout = function() {
  signOut(auth).then(() => {
    window.location.href = "admin-login.html";
  });
}

  </script>
</head>
<body>
  <h2>FIK STORE - Admin Dashboard</h2>
  <p id="statusLogin">Memeriksa status login...</p>
  <button onclick="logout()">Logout</button>
  <table border="1" cellspacing="0" cellpadding="5">
    <thead>
      <tr>
        <th>Nama</th>
        <th>Nomor</th>
        <th>Produk</th>
        <th>Metode</th>
        <th>Bukti</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody id="transaksiTableBody">
      <!-- Isi transaksi -->
    </tbody>
  </table>
</body>
</html>
